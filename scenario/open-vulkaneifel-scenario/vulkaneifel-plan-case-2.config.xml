<?xml version="1.0" ?>
<!DOCTYPE config SYSTEM "http://www.matsim.org/files/dtd/config_v2.dtd">
<config>
    <module name="global">
        <param name="randomSeed" value="4711"/>
        <param name="coordinateSystem" value="EPSG:25832"/>
        <param name="numberOfThreads" value="12"/>
    </module>
    <module name="controler">
        <param name="lastIteration" value="500"/>
        <param name="overwriteFiles" value="deleteDirectoryIfExists"/>
        <param name="runId" value="vulkaneifel-v1.0-25pct"/>
        <param name="outputDirectory" value="output/"/>
        <param name="writeEventsInterval" value="250"/>
        <param name="writePlansInterval" value="250"/>
    </module>
    <module name="qsim">
        <param name="endTime" value="36:00:00"/>
        <param name="flowCapacityFactor" value="0.25"/>
        <param name="mainMode" value="car"/>
        <param name="numberOfThreads" value="12"/>
        <param name="startTime" value="00:00:00"/>
        <param name="storageCapacityFactor" value="0.25"/>
        <param name="stuckTime" value="30.0"/>
        <param name="trafficDynamics" value="kinematicWaves"/>
        <param name="vehiclesSource" value="modeVehicleTypesFromVehiclesData"/>
        <param name="insertingWaitingVehiclesBeforeDrivingVehicles" value="true"/>
        <param name="usePersonIdForMissingVehicleId" value="false"/>
    </module>
	<module name="multiModeDrt">
		<parameterset type="drt">
			<parameterset type="ExtensiveInsertionSearch"/>
				<!--  If true, the startLink is changed to last link in the current schedule, so the taxi starts the next day at the link where it stopped operating the day before. False by default.  -->
				<param name="changeStartLinkToLastLinkInSchedule" value="false"/>
				<!--  Defines the slope of the maxTravelTime estimation function (optimisation constraint), i.e. maxTravelTimeAlpha * estimated_drt_travel_time + maxTravelTimeBeta. Alpha should not be smaller than 1.  -->
				<param name="maxTravelTimeAlpha" value="2.0"/>
				<!--  Defines the shift of the maxTravelTime estimation function (optimisation constraint), i.e. maxTravelTimeAlpha * estimated_drt_travel_time + maxTravelTimeBeta. Beta should not be smaller than 0.  -->
				<param name="maxTravelTimeBeta" value="1200.0"/>
				<!--  Max wait time for the bus to come (optimisation constraint).  -->
				<param name="maxWaitTime" value="7200"/>
                <!-- Operational Scheme, either of door2door, stopbased or serviceAreaBased. door2door by default -->
                <param name="operationalScheme" value="serviceAreaBased" />
                <!-- allows to configure a service area per drt mode.Used with serviceArea Operational Scheme -->
                <param name="drtServiceAreaShapeFile" value="vulkaneifel-v1.0-25pct/dilutionArea/dilutionArea.shp" />
				<!--  Bus stop duration.  -->
				<param name="stopDuration" value="1.0"/>
				<!--  An XML file specifying the vehicle fleet. The file format according to dvrp_vehicles_v1.dtd  -->
				<param name="vehiclesFile" value="vulkaneifel-v1.0-25pct/drt-vehicles/50-1_seater-drt-vehicles.xml"/>
				<!--  Writes out detailed DRT customer stats in each iteration. True by default.  -->
				<param name="writeDetailedCustomerStats" value="true"/>
				<param name="rejectRequestIfMaxWaitOrTravelTimeViolated" value="false"/>
            <parameterset type="rebalancing" >
                <!-- Specifies how often empty vehicle rebalancing is executed. Must be positive. Default is 1800 s. Expects an Integer Value -->
                <param name="interval" value="1800" />
                <!-- Maximum remaining time before busy vehicle becomes idle to be considered as soon-idle vehicle. Default is 900 s. In general should be lower than interval (e.g. 0.5 x interval) -->
                <param name="maxTimeBeforeIdle" value="900.0" />
                <!-- Minimum remaining service time of an idle/busy vehicle to be considered as rebalancable/soon-idle (respectively). Default is 3600 s. In general, should be higher than interval (e.g. 2 x interval). -->
                <param name="minServiceTime" value="3600.0" />
                <parameterset type="minCostFlowRebalancingStrategy" >
                    <!-- Defines the time horizon for predicting the demand. Used when 'zonalDemandEstimatorType' is not set to 'None'. Default value is 1800 s. -->
                    <param name="demandEstimationPeriod" value="1800" />
                    <!-- Possible values: EstimatedDemand, EqualRebalancableVehicleDistribution, EqualVehicleDensity, EqualVehiclesToPopulationRatio -->
                    <param name="rebalancingTargetCalculatorType" value="EstimatedDemand" />
                    <!-- alpha coefficient in linear target calculation. In general, should be lower than 1.0 to prevent over-reacting and high empty mileage. -->
                    <param name="targetAlpha" value="1.0" />
                    <!-- beta constant in linear target calculation. In general, should be lower than 1.0 to prevent over-reacting and high empty mileage. -->
                    <param name="targetBeta" value="0.3" />
                    <!-- Defines the methodology for demand estimation. Can be one of [PreviousIterationDemand, None]. Current default is PreviousIterationDemand -->
                    <param name="zonalDemandEstimatorType" value="PreviousIterationDemand" />
                </parameterset>
            </parameterset>
            <parameterset type="zonalSystem" >
                <!-- size of square cells used for demand aggregation. Depends on demand, supply and network. Often used with values in the range of 500 - 2000 m -->
                <param name="cellSize" value="5000" />
                <!-- Possible values: random, mostCentral -->
                <param name="zoneTargetLinkSelection" value="random" />
                <!-- Logic for generation of zones for the DRT zonal system. Value can be: [GridFromNetwork, ShapeFile]. -->
                <param name="zonesGeneration" value="GridFromNetwork" />
            </parameterset>
			<parameterset type="drtfare">
				<param name="basefare" value="0.0"/>
				<!--  Daily subscription fee (fee = positive value)  -->
				<param name="dailySubscriptionFee" value="0.0"/>
				<!--  drt fare per meter (fee = positive value)  -->
				<param name="distanceFare_m" value="0.0"/>
				<!--  drt fare per hour (fee = positive value)  -->
				<param name="timeFare_h" value="0.0"/>
				<!--  Minimum fare per trip (paid instead of the sum of base, time and distance fare if that sum would be lower than the minimum fare, fee = positive value).  -->
				<param name="minFarePerTrip" value="0.0"/>
			</parameterset>
        </parameterset>
		</module>
	<module name="dvrp">
		<!--  Mode of which the network will be used for routing vehicles, calculating travel times, etc. (fleet operator's perspective). If null, no mode filtering is done; the standard network (Scenario.getNetwork()) is used  -->
		<param name="networkModes" value="drt"/>
		<!--  Used for estimation of travel times for VrpOptimizer by means of the exponential moving average. The weighting decrease, alpha, must be in (0,1]. We suggest small values of alpha, e.g. 0.05. The averaging starts from the initial travel time estimates. If not provided, the free-speed TTs is used as the initial estimates For more info see comments in: VrpTravelTimeEstimator, VrpTravelTimeModules, DvrpModule.  -->
		<param name="travelTimeEstimationAlpha" value="0.05"/>
		<parameterset type="travelTimeMatrix">
			<param name="cellSize" value="200"/>
		</parameterset>
	</module>
    <module name="network">
        <param name="inputNetworkFile" value="vulkaneifel-v1.0-25pct.network_with_drt.xml.gz"/>
    </module>
    <module name="plans">
        <param name="inputPlansFile" value="vulkaneifel-v1.0-25pct.plans-drt-only.xml.gz"/>
    </module>
    <module name="vehicles">
        <param name="vehiclesFile" value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/vulkaneifel/openVulkaneifel/input/vulkaneifel-v1.0-25pct/vulkaneifel-v1.0.vehicles.xml.gz"/>
    </module>
    <module name="transit">
        <param name="transitScheduleFile" value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/vulkaneifel/openVulkaneifel/input/vulkaneifel-v1.0-25pct/vulkaneifel-v1.0.transitSchedule.xml.gz"/>
        <param name="useTransit" value="true"/>
        <param name="vehiclesFile" value="https://svn.vsp.tu-berlin.de/repos/public-svn/matsim/scenarios/countries/de/vulkaneifel/openVulkaneifel/input/vulkaneifel-v1.0-25pct/vulkaneifel-v1.0.transitVehicles.xml.gz"/>
    </module>
    <module name="transitRouter">
        <param name="extensionRadius" value="500.0"/>
        <!--  Factor with which direct walk generalized cost is multiplied before it is compared to the pt generalized cost.  Set to a very high value to reduce direct walk results.  -->
        <param name="directWalkFactor" value="1.0"/>
        <!--  maximum beeline distance between stops that agents could transfer to by walking  -->
        <param name="maxBeelineWalkConnectionDistance" value="300.0"/>
    </module>
    <module name="planscalcroute">
        <param name="networkModes" value="car,ride"/>
        <param name="clearDefaultTeleportedModeParams" value="true"/>
        <parameterset type="teleportedModeParameters">
            <param name="beelineDistanceFactor" value="1.4"/>
            <param name="mode" value="walk"/>
            <param name="teleportedModeFreespeedFactor" value="null"/>
            <param name="teleportedModeSpeed" value="1.1111111111111112"/>
        </parameterset>
        <parameterset type="teleportedModeParameters">
            <param name="beelineDistanceFactor" value="1.4"/>
            <param name="mode" value="bike"/>
            <param name="teleportedModeFreespeedFactor" value="null"/>
            <param name="teleportedModeSpeed" value="3.0555555555555554"/>
        </parameterset>
    </module>
    <module name="travelTimeCalculator">
        <param name="analyzedModes" value="car"/>
        <param name="separateModes" value="true"/>
    </module>
    <module name="planCalcScore">
        <param name="fractionOfIterationsToStartScoreMSA" value="1.0"/>
        <parameterset type="scoringParameters">
		<parameterset type="modeParams">
                <param name="constant" value="-3.345540765115424"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-1"/>
                <param name="mode" value="drt"/>
                <param name="dailyMonetaryConstant" value="-1.9"/>
            </parameterset>
            <parameterset type="modeParams">
                <param name="constant" value="-3.345540765115424"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-1"/>
                <param name="mode" value="pt"/>
                <param name="dailyMonetaryConstant" value="-1.9"/>
            </parameterset>
            <parameterset type="modeParams">
                <param name="constant" value="-1.2451777084974678"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-2.5"/>
                <param name="mode" value="car"/>
                <param name="monetaryDistanceRate" value="-0.0002"/>
                <param name="dailyMonetaryConstant" value="-5.3"/>
            </parameterset>
            <parameterset type="modeParams">
                <param name="constant" value="-5.3658418007142075"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-2"/>
                <param name="mode" value="ride"/>
                <param name="monetaryDistanceRate" value="-0.0002"/>
            </parameterset>
            <parameterset type="modeParams">
                <param name="constant" value="0"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="0"/>
                <param name="mode" value="walk"/>
            </parameterset>
            <parameterset type="modeParams">
                <param name="constant" value="-3.210459389976668"/>
                <param name="marginalUtilityOfTraveling_util_hr" value="-3"/>
                <param name="mode" value="bike"/>
            </parameterset>
        </parameterset>
    </module>
    <module name="strategy">
        <param name="fractionOfIterationsToDisableInnovation" value="0.8"/>
        <parameterset type="strategysettings">
            <param name="strategyName" value="ChangeExpBeta"/>
            <param name="weight" value="0.7"/>
            <param name="subpopulation" value="person"/>
        </parameterset>
        <parameterset type="strategysettings">
            <param name="strategyName" value="ReRoute"/>
            <param name="weight" value="0.1"/>
            <param name="subpopulation" value="person"/>
        </parameterset>
        <parameterset type="strategysettings">
            <param name="strategyName" value="TimeAllocationMutator"/>
            <param name="weight" value="0.05"/>
            <param name="subpopulation" value="person"/>
        </parameterset>
    </module>
    <module name="TimeAllocationMutator">
        <param name="mutationRange" value="7200.0"/>
        <param name="mutationAffectsDuration" value="false"/>
    </module>
    <module name="changeMode">
        <!-- provide a comma-separated list of leg modes -->
        <param name="modes" value="car,ride,pt,bike,walk" />
        <param name="ignoreCarAvailability" value="false" />
    </module>
</config>
